
raid_file_system: "xfs"
raid_mountpoint: "/data"
raid_device: "/dev/md127"
system_devices: "/dev/sda|/dev/sdb"

documentroot: "{{ raid_mountpoint }}/www/azureshop"
prestashop_dir: "{{ documentroot }}/current/prestashop"

prestashop_firstname: "herve"
prestashop_lastname: "leclerc"
prestashop_email: "herve.leclerc@alterway.fr"
prestashop_dbname: "prestashop"
prestashop_user: "prestashop"
prestashop_password: "prestashop"

prestashop_fqdn: "azureshop.com"
prestashop_owner: "www-data"
prestashop_group: "www-data"

azure_suffix: ".cloudapp.azure.com"

apache_remove_default_vhost: true
apache_listen_port: 80
apache_vhosts:
  - servername: "{{ prestashop_fqdn }}"
    serveralias: "{{ prestashop_lb_name }}{{ azure_suffix }}"
    documentroot: "{{ prestashop_dir }}"
    extra_parameters: |
              ProxyPassMatch ^/(.*\.php(/.*)?)$ "fcgi://127.0.0.1:9000{{ prestashop_dir }}"
   
apache_mods_enabled:
  - rewrite.load
  - actions.load 
  - alias.load
  - expires.load

php_enable_php_fpm: true
php_use_managed_ini: true
php_opcache_enabled_in_ini: true
php_opcache_enable: "1"
php_opcache_enable_cli: "0"
php_opcache_memory_consumption: "96"
php_opcache_interned_strings_buffer: "16"
php_opcache_max_accelerated_files: "4096"
php_opcache_max_wasted_percentage: "5"
php_opcache_validate_timestamps: "1"
php_opcache_revalidate_freq: "2"
php_opcache_max_file_size: "0"

# php.ini values
php_memory_limit: "512M"

php_packages:
  - php7.0-common
  - php7.0-cli
  - php7.0-fpm
  - php7.0-gd
  - php7.0-curl
  - php7.0-opcache
  - php7.0-xml
  - php7.0-mbstring
  - php7.0-mysql
  - php7.0-mcrypt 


# Localisation
#mysql_datadir: "/var/lib/mysql"
mysql_datadir: "{{ raid_mountpoint }}/lib/mysql"

# Mysql Default
mysql_enabled_on_startup: yes
mysql_root_password: root
overwrite_global_mycnf: yes

mysql_replication_user: {name: 'replicator', password: 'prestashop'}

mysql_databases: 
  - name: "{{ prestashop_dbname }}"
    encoding: utf8
    collation: utf8_general_ci
    replicate: 1
    
mysql_users: 
  - name: "{{ prestashop_user }}"
    host: "%"
    password: "{{ prestashop_password }}"
    priv: "{{ prestashop_dbname }}.*:ALL"
 
ansistrano_deploy_via: "download_unarchive"    
ansistrano_get_url: "https://filet.alterway.fr/selif/prestashop1615frtar.gz"
ansistrano_deploy_to: "/{{ raid_mountpoint }}/www/azureshop"
ansistrano_allow_anonymous_stats: no

lsyncd_directories:
  - "{{ documentroot }}/releases/{{ ansistrano_release_version }}/prestashop"
  
  